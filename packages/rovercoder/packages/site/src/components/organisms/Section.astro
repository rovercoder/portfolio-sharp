---
import Background from "../helpers/Background.astro";
import type { BackgroundProperties } from "../helpers/Background.types";
import type { FlexProperties as FlexDisplayProperties } from "./Section.types";
import type { GridProperties as GridDisplayProperties } from "./Section.types";
interface Props {
    minHeight?: string;
    padding?: string;
    backgroundProperties?: BackgroundProperties;
    displayProperties: FlexDisplayProperties | GridDisplayProperties;
}
const { 
    minHeight: sectionMinHeight, 
    padding: sectionPadding, 
    backgroundProperties: sectionBackgroundProperties, 
    displayProperties: sectionDisplayProperties 
} = Astro.props;

let sectionDisplay;

let sectionFlexDirection;
let sectionFlexWrap;
let sectionJustifyContent;
let sectionAlignItems;
let sectionAlignContent;
let sectionGap;

let sectionGridTemplateColumns;
let sectionGridTemplateRows;
let sectionGridTemplateAreas;

switch (sectionDisplayProperties.display) {
    case 'flex': 
        sectionDisplay = sectionDisplayProperties.display;
        sectionFlexDirection = sectionDisplayProperties.flexDirection;
        sectionFlexWrap = sectionDisplayProperties.flexWrap;
        sectionJustifyContent = sectionDisplayProperties.justifyContent;
        sectionAlignItems = sectionDisplayProperties.alignItems;
        sectionAlignContent = sectionDisplayProperties.alignContent;
        sectionGap = sectionDisplayProperties.gap;
        break;
    case 'grid':
        sectionDisplay = sectionDisplayProperties.display;
        sectionGridTemplateColumns = sectionDisplayProperties.gridTemplateColumns;
        sectionGridTemplateRows = sectionDisplayProperties.gridTemplateRows;
        sectionGridTemplateAreas = sectionDisplayProperties.gridTemplateAreas;
        sectionGap = sectionDisplayProperties.gap;
        break;
    default:
        throw new Error(`Unsupported display properties for section! ${JSON.stringify(sectionDisplayProperties)}`);
}
---

<section>
    <Background imageUrl={sectionBackgroundProperties?.backgroundImageUrl} color={sectionBackgroundProperties?.backgroundColor} imageRepeat={sectionBackgroundProperties?.backgroundImageRepeat} imageSize={sectionBackgroundProperties?.backgroundImageSize} borderRadius={sectionBackgroundProperties?.backgroundBorderRadius} type={sectionBackgroundProperties?.backgroundType}>
        <div class="section-content">
            <slot />
        </div>
    </Background>
</section>

<style lang="scss" define:vars={{ sectionMinHeight, sectionPadding, sectionDisplay, sectionFlexDirection, sectionFlexWrap, sectionJustifyContent, sectionAlignItems, sectionAlignContent, sectionGap, sectionGridTemplateColumns, sectionGridTemplateRows, sectionGridTemplateAreas }}>
    @use '/src/styles/variables.scss' as *;

	section {
        position: relative;
	}

    .section-content {
        position: relative;
		padding: var(--sectionPadding);
		min-height: var(--sectionMinHeight);
		display: var(--sectionDisplay);
		flex-direction: var(--sectionFlexDirection);
		flex-wrap: var(--sectionFlexWrap);
		justify-content: var(--sectionJustifyContent);
		align-items: var(--sectionAlignItems);
		align-content: var(--sectionAlignContent);
        gap: var(--sectionGap);
        grid-template-columns: var(--sectionGridTemplateColumns);
        grid-template-rows: var(--sectionGridTemplateRows);
        grid-template-areas: var(--sectionGridTemplateAreas);
        transition: $sectionTransition;
    }
</style>
