---
import { prepareInlineScript } from '../../helpers/scripts';


// import ThemeIcon from './ThemeIcon.astro';
interface Props {
    backgroundColor: string;
}
const { 
    backgroundColor: headerBackgroundColor 
} = Astro.props;
---

<header>
    <nav>
        <div class="logo-container-container"><slot name="logo" /></div>
        <!-- <ThemeIcon /> -->
        <div class="nav-links-hamburger-overlap-container">
            <div class="nav-links-overlap-container">
                <div class="nav-links-container"><slot name="navigation" /></div>
            </div>
            <div class="hamburger-overlap-container">
                <div class="hamburger-container"><slot name="hamburger" /></div>
            </div>
        </div>    
    </nav>
    <div class="overlay overlay-navigation-menu" aria-hidden="true">
        <slot name="navigation-menu" />
    </div>
</header>
<script>
    import "/src/scripts/menu.ts";
</script>
<script is:inline set:html={await prepareInlineScript("/src/scripts/.tsc-build/header.js")} data-script-deduplication-keep="first" />

<style lang="scss" define:vars={{ headerBackgroundColor }}>
    @use '/src/styles/variables.scss' as *;

    header {
        background-color: var(--headerBackgroundColor);
        width: 100%;
    }

    header nav {
        display: inline-flex;
        justify-content: space-between;
        width: 100%;
        height: inherit;
    }

    .nav-links-hamburger-overlap-container {
        display: grid;

        > * {
            grid-area: 1 / 1 / 2 / 2;
        }
    }

    .nav-links-hamburger-overlap-container > * {
        display: inline-flex;
        flex-direction: row;
        justify-content: end;
    }

    .logo-container-container {
        display: flex;
        align-items: center;
        align-self: center;
        padding: 2vh;
        height: inherit;
    }

    .nav-links-container {
        padding: 2vh;
    }

    .hamburger-container {
        display: flex;
        align-items: center;
        align-self: center;
        padding: 2vh;
        height: inherit;
    }

    header .overlay:not(.shown) {
        display: none;
    }
</style>

<style lang="scss" is:global>
    @use '/src/styles/variables.scss' as *;

    @media screen and (min-width: $mobileBreakpoint) {
        .overlay-navigation-menu {
            display: none !important;
        }
        /** :not doesn't work alone. Needs html in front of it. */
        html:not(.overlay-open) .hamburger-container {
            visibility: hidden;

            * {
                transition: none !important;
                animation: none !important;
            }
        }

        .overlay-open .nav-links-container {
            visibility: hidden;
        }
    }

    @media screen and (max-width: calc($mobileBreakpoint - 0.000001px)) {
        .nav-links-container {
            display: none;
        }
    }
</style>
