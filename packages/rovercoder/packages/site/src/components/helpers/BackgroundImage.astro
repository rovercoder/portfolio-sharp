---
interface Props { 
	backgroundUrl: string;
	backgroundColor?: string | undefined;
	backgroundRepeat?: string | undefined;
	backgroundSize?: string | undefined;
	backgroundBorderRadius?: string | undefined;
	type?: string | undefined;
}
var { backgroundUrl, backgroundColor, backgroundRepeat, backgroundSize = 'cover', backgroundBorderRadius, type = 'absolute' } = Astro.props;
backgroundUrl = `url(${backgroundUrl})`;
var backgroundPosition;
var backgroundHeight;
var backgroundWidth;
var backgroundTop;
var backgroundLeft;
switch (type) {
	case 'fixedFullScreen': 
		backgroundPosition = 'fixed';
		backgroundHeight = '100%';
		backgroundWidth = '100%';
		backgroundTop = '0px';
		backgroundLeft = '0px';
		break;
	case 'absolute':
		backgroundPosition = 'absolute';
		backgroundHeight = '100%';
		backgroundWidth = '100%';
		backgroundTop = '0px';
		backgroundLeft = '0px';
		break;
	default:
		throw Error(`Not supported background type! Type: ${type}`);
}
---

<div class="wrapper">
	<div class="background-image-wrapper">
		<div class='background-image' style={backgroundPosition === 'fixed' && "transform: translateZ(0); will-change: transform;" /** For iOS Safari browsers */}></div>
	</div>
	<div class="content">
		<slot />
	</div>
</div>

<style define:vars={{ backgroundUrl, backgroundColor, backgroundRepeat, backgroundSize, backgroundBorderRadius, backgroundPosition, backgroundHeight, backgroundWidth, backgroundTop, backgroundLeft }}>
	.wrapper {
		position: relative;
		border-radius: var(--backgroundBorderRadius);
		overflow: hidden;
	}

	.background-image-wrapper {
		clip-path: inset(0);
		position: absolute;
		top: 0;
		left: 0;
		width: 100%;
		height: 100%;
	}

	.background-image {
		position: var(--backgroundPosition);
		height: var(--backgroundHeight);
		width: var(--backgroundWidth);
		top: var(--backgroundTop);
		left: var(--backgroundLeft);
		display: block;
        background-image: var(--backgroundUrl);
        background-color: var(--backgroundColor);
        background-repeat: var(--backgroundRepeat);
		background-size: var(--backgroundSize);
		background-position: center center;
		transition: opacity 150ms ease-in-out;
	}

	.content {
		position: relative;
	}
</style>
