---
interface Props { 
	backgroundUrl: string;
	backgroundColor?: string | undefined;
	backgroundRepeat?: string | undefined;
	backgroundSize?: string | undefined;
	backgroundBorderRadius?: string | undefined;
	type?: string | undefined;
}
var { 
	backgroundUrl: backgroundImageBackgroundUrl, 
	backgroundColor: backgroundImageBackgroundColor, 
	backgroundRepeat: backgroundImageBackgroundRepeat, 
	backgroundSize: backgroundImageBackgroundSize = 'cover', 
	backgroundBorderRadius: backgroundImageBackgroundBorderRadius, 
	type: backgroundImageType = 'absolute' 
} = Astro.props;
backgroundImageBackgroundUrl = `url(${backgroundImageBackgroundUrl})`;
var backgroundImageBackgroundPosition;
var backgroundImageBackgroundHeight;
var backgroundImageBackgroundWidth;
var backgroundImageBackgroundTop;
var backgroundImageBackgroundLeft;
switch (backgroundImageType) {
	case 'fixedFullScreen': 
		backgroundImageBackgroundPosition = 'fixed';
		backgroundImageBackgroundHeight = '100%';
		backgroundImageBackgroundWidth = '100%';
		backgroundImageBackgroundTop = '0px';
		backgroundImageBackgroundLeft = '0px';
		break;
	case 'absolute':
		backgroundImageBackgroundPosition = 'absolute';
		backgroundImageBackgroundHeight = '100%';
		backgroundImageBackgroundWidth = '100%';
		backgroundImageBackgroundTop = '0px';
		backgroundImageBackgroundLeft = '0px';
		break;
	default:
		throw Error(`Not supported background type! Type: ${backgroundImageType}`);
}
---

<div class="wrapper">
	<div class="background-image-wrapper">
		<div class="background-image" style={backgroundImageBackgroundPosition === 'fixed' && "transform: translateZ(0); will-change: transform;" /** For iOS Safari browsers */}></div>
	</div>
	<div class="content">
		<slot />
	</div>
</div>

<style define:vars={{ backgroundImageBackgroundUrl, backgroundImageBackgroundColor, backgroundImageBackgroundRepeat, backgroundImageBackgroundSize, backgroundImageBackgroundBorderRadius, backgroundImageBackgroundPosition, backgroundImageBackgroundHeight, backgroundImageBackgroundWidth, backgroundImageBackgroundTop, backgroundImageBackgroundLeft }}>
	.wrapper {
		position: relative;
		border-radius: var(--backgroundImageBackgroundBorderRadius);
		width: 100%;
		height: 100%;
		overflow: hidden;
	}

	.background-image-wrapper {
		clip-path: inset(0);
		position: absolute;
		top: 0;
		left: 0;
		width: 100%;
		height: 100%;
	}

	.background-image {
		position: var(--backgroundImageBackgroundPosition);
		height: var(--backgroundImageBackgroundHeight);
		width: var(--backgroundImageBackgroundWidth);
		top: var(--backgroundImageBackgroundTop);
		left: var(--backgroundImageBackgroundLeft);
		display: block;
        background-image: var(--backgroundImageBackgroundUrl);
        background-color: var(--backgroundImageBackgroundColor);
        background-repeat: var(--backgroundImageBackgroundRepeat);
		background-size: var(--backgroundImageBackgroundSize);
		background-position: center center;
		transition: opacity 150ms ease-in-out;
	}

	.content {
		position: relative;
		width: 100%;
		height: 100%;
	}
</style>
