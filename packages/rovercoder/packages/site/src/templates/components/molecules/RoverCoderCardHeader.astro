---
import Icon from "../../../components/atoms/Icon.astro";
import Image from "../../../components/atoms/Image.astro";
import CardHeaderDefault from "../../../components/molecules/CardHeaderDefault.astro";
import type { CardHeaderIconFnType, CardHeaderImageFnType, ImageProps } from "../../../components/molecules/CardHeaderDefault.types";
import RoverCoderText from "../atoms/RoverCoderText.astro";
import RoverCoderImageBrowserOverlay from "./RoverCoderImageBrowserOverlay.astro";

interface Props {
    image?: ImageProps | ImageProps[];
    imageIsIcon?: boolean;
    info?: string;
}
const { image, imageIsIcon, info } = Astro.props;

const images: ImageProps[] | undefined = (image == null || (Array.isArray(image) && image.filter(x => x != null).length === 0)) ? undefined : (Array.isArray(image) ? image.filter(x => x != null) : [image]);

const imageHeight = '15rem';
const imageImageSize = 'cover';
let imageBorderRadius: string | undefined;
const iconSize = '3rem';
const iconMargin = '1rem';

const textColor = '#000000';

const infoIconButtonUrl = '/_assets/images/site/icons/info.svg';
const infoIconButtonSize = '2rem';
const infoIconButtonBorderRadius = '0.25rem';
const infoIconButtonColor = '#ffffff53';
const infoIconButtonMargin = '0.3rem';
const infoIconButtonPadding = '0.125rem';

const imageBrowserButtonIconUrl = '/_assets/images/site/icons/photo-browser.svg';
const imageBrowserButtonSize = '2rem';
const imageBrowserButtonBorderRadius = '0.25rem';
const imageBrowserButtonColor = '#ffffff53';
const imageBrowserButtonMargin = '0.3rem';
const imageBrowserButtonPadding = '0.125rem';

const previousPhotoNavigationButtonIconUrl = '/_assets/images/site/icons/previous.svg';
const nextPhotoNavigationButtonIconUrl = '/_assets/images/site/icons/next.svg';
const photoNavigationButtonSize = '1.75rem';
const photoNavigationButtonBorderRadius = '0.25rem';
const photoNavigationButtonColor = '#ffffff53';
const photoNavigationButtonMargin = '0.3rem';
const photoNavigationButtonPadding = '0.125rem';
---

<CardHeaderDefault 
        images={images} 
        imageIsIcon={imageIsIcon} 
        imageHeight={imageHeight} 
        imageImageSize={imageImageSize}
        imageBorderRadius={imageBorderRadius} 
        iconSize={iconSize} 
        iconMargin={iconMargin} 
        info={info}>
    <div slot="icon">
        {((args) => <Icon url={args.icon.url} color={args.icon.color} imageSize={args.icon.imageSize} borderRadius={args.iconBorderRadius} containerMargin={args.iconMargin} size={args.iconSize} />) satisfies CardHeaderIconFnType}
    </div>
    <div slot="image">
        {((args) => <Image url={args.image.url} color={args.image.color} imageSize={args.imageSize ?? args.image.imageSize} imageRepeat={args.image.imageRepeat} borderRadius={args.imageBorderRadius} height={args.imageHeight} />) satisfies CardHeaderImageFnType}
    </div>
    <Icon slot="info-button" url={infoIconButtonUrl} color={infoIconButtonColor} borderRadius={infoIconButtonBorderRadius} containerMargin={infoIconButtonMargin} containerPadding={infoIconButtonPadding} size={infoIconButtonSize} />
    <RoverCoderText slot="info-text" type="card-hint" content={info ?? ''} color={textColor} isParagraph />
    <Icon slot="image-browser-open-button" url={imageBrowserButtonIconUrl} color={imageBrowserButtonColor} borderRadius={imageBrowserButtonBorderRadius} containerMargin={imageBrowserButtonMargin} containerPadding={imageBrowserButtonPadding} size={imageBrowserButtonSize} />
    <RoverCoderImageBrowserOverlay slot="image-browser" images={images} />
    <Icon slot="image-previous-navigator-button" url={previousPhotoNavigationButtonIconUrl} color={photoNavigationButtonColor} borderRadius={photoNavigationButtonBorderRadius} containerMargin={photoNavigationButtonMargin} containerPadding={photoNavigationButtonPadding} size={photoNavigationButtonSize} />
    <Icon slot="image-next-navigator-button" url={nextPhotoNavigationButtonIconUrl} color={photoNavigationButtonColor} borderRadius={photoNavigationButtonBorderRadius} containerMargin={photoNavigationButtonMargin} containerPadding={photoNavigationButtonPadding} size={photoNavigationButtonSize} />
</CardHeaderDefault>
